<!DOCTYPE html>
<html lang="en">
	<head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<script type="text/javascript" src="/bjc-r/llab/loader.js"></script>
		<title>Unit 4 Lab 6: Website Data, Page 2</title>
	</head>

	<body>
        <img class="imageRight" src="/bjc-r/img/icons/teachers-choice.png" alt="Teacher's Choice" title="Teacher's Choice" />
        <h2>Web Scraping Techniques (Teacher's Choice)</h2>
        <div class="ifTime">
			<ol>
				<li>If you don't have it open, load <a class="run" href="/bjc-r/prog/4-internet/old/U4L6-HttpBlock.xml"> U4L3-HttpBlock project</a>, and try the <code>http</code> block with a <em>different</em> URL. It likely won't work, but try it, and keep reading.</li>
			</ol>
            <p>Use the U4L3-HttpBlock file as a starter project for any web scraping app you build; it has <code>proxied http</code> and the <code>substring</code> blocks already installed.</p>
		</div>
		<img class="indent" src="/bjc-r/img/4-internet/empty-result.png" alt="http block reporting ()" title="http block reporting ()" /><br />
		<div class="sidenoteBig">Most websites receive a request coming from Snap<em>!</em> and say "this isn't a real web browser query, so I'm not answering." The <code>proxied http</code> block uses proxy (replacement or stand-in) servers to call the URL you enter. The proxy server performs the request as a browser would and sends the information to Snap<em>!</em>.</div>
        <p>You likely got an <em>empty</em> result back. For security, a website (such as the Snap<em>!</em>Â server) is not allowed to send a request to another website. Servers expect browsers to send website requests.</p>
        <p>There is a JavaScript program in this Snap<em>!</em> project called <code>proxied http</code> that uses a proxy (stand-in) server to fool the requested web site into sending data it wouldn't normally send.</p>
        
        
        <h3>Using <code>proxied http</code> to Access Websites</h3>
		<p>The <code>proxied http</code> block will allow you to program Snap<em>!</em> to access websites as part of your projects. After accessing a site, you'll need to isolate the specific information you want from the HTML. Extracting the information out of the formatting is called <strong>scraping</strong> the web page.</p>
        <div class="ifTime">
			<ol start="2">
                <li>
                    <img class="imageRight" src="/bjc-r/img/4-internet/http-http.png" alt="Don't include the 'http://' in the http block input slot." title="Don't include the 'http://' in the http block input slot." />
                    Try the <img src="/bjc-r/img/4-internet/proxied-http.png" alt="proxied http://"> block with your URL. This time, it <em>should</em> work. Be sure <em>not</em> to include the "http://" in the input slot. 
                </li>
            </ol>
        </div>
        <div class="takeNote">
        	<h4><strong>What if <code>proxied http</code> doesn't work?</strong></h4>
        	If <code>proxied http</code> doesn't work, you can skip the remaining pages in this lab. You might find them interesting to read, but will not be able to do the projects. If you have access to the Internet somewhere that this block works, you can use Snap<em>!</em> to code web scraping projects such as a <a href="/bjc-r/cur/programming/6-computers/optional-projects/weather-app.html?topic=nyc_bjc%2F4-internet.topic&course=bjc4nyc.html&novideo&noassignment">Weather App</a>.
			<div class="endnote"><strong>What's going on?</strong> You may not be able to use the <code>proxied http</code> block if your network has certain security settings (like a <a href="https://en.wikipedia.org/wiki/Firewall_(computing)" target="_blank">firewall</a>) that prohibit using proxy servers to access blocked content.</div> 
        </div>
        
        
		<h3>Using String Reporters to Manage Data</h3>
        <p>Like the <a href="/bjc-r/cur/programming/4-internet/old/6-web-data/1-read-web.html?topic=nyc_bjc%2F4-internet.topic&course=bjc4nyc.html&novideo&noassignment">two custom <code>substring</code> blocks</a>, which you can use to extract specific information from a webpage, you can also use <code>split</code> to manage the complex data returned from an HTTP query. Use <code>split</code> to break up a long string of text into a list of smaller strings according to some marker (spaces, tabs, commas, new lines, etc.).</p>
        <div class="ifTime">
            <ol start="3">
                <li>
                	Try the <img src="/bjc-r/img/4-internet/proxied-http.png" alt="proxied http://"> block with the following URL, and use <img class="inline" src="/bjc-r/img/4-internet/split-by-line.png" alt="split () by (line)" title="split () by (line)" /> to create a list of the lines of HTML code from that page.<br />
                    <p class="center"><a href="https://www.wunderground.com/cgi-bin/findweather/getForecast?query=New+York,NY" target="_blank">www.wunderground.com/cgi-bin/findweather/getForecast?query=New+York,NY</a></p>	
                </li>
                <li>
                	Use a <code>substring</code> block to write a script that reports a list of the lines of HTML starting from <code>&lt;div id="current"</code> and store that list as a variable (such as <var>weatherdata</var>).<br />
                	<div class="endnote">You can search through this list for the line with the data that you need and then clean out all the HTML formatting that you don't need.</div>
                    <div class="todo">
                    	This image needs to be redone according to the Weather Underground instructions on this page as soon as PROXIED HTTP works. :/ --MF 2016-12-20<br />
                         The report of your script should look something like this:
                         <img class="indent" src="/bjc-r/img/4-internet/weather-list.png" alt="output of 'www.weatherstreet.com/weather-forecast/New-York-NY-10001.htm' starting with '<!-- START OF CURRENT CONDITIONS'" title="output of 'www.weatherstreet.com/weather-forecast/New-York-NY-10001.htm' starting with '<!-- START OF CURRENT CONDITIONS'" />
</div>
                </li>
            </ol>
        </div>
        
        
        <h3>Requesting Data Using URL Tags</h3>
        <div class="sidenote">Remember, a <a href="/bjc-r/cur/programming/4-internet/1-reliable-communication/1-what-is-internet.html?topic=nyc_bjc%2F4-internet.topic&course=bjc4nyc.html&novideo&noassignment">URL</a> (Uniform Resource Locator) is a reference to an Internet resource such as a Web page.</div>
        <p>Many websites communicate information in the details in their URLs.</p>
        <div class="ifTime">
            <ol start="5">
                <li>Starting from <a href="https://www.google.com" target="_blank">google.com</a>, type a one-word web search. What is the URL of your current web page?</li>
                <li><em>Change the URL</em> to make Google search for a new topic.</li>
                <div class="sidenoteBig">When you see <strong>https://</strong> instead of <strong>http://</strong> in the browser location bar, it means the information exchanged is secured via encryption.</div>
                <div class="takeNote">Your URL may add some details, but one of the simplest formats is <a href="https://www.google.com/#q=snap" target="_blank">https://www.google.com/#q=snap</a>.</div>
                <li>Build a small app that asks for a one-word search query, then displays the URL to use for that Google search, and the HTML of the results from the search. Warning: don't expect the HTML to be easy to read!</li>
                <div class="endnote">Remember that the results of <code>ask</code> are available from a reporter called <em>answer</em>. As before, use the <img src="/bjc-r/img/4-internet/proxied-http.png" alt="Proxied HTTP block"> block to retrieve the HTML.</div>
			</ol>
        </div>         
        <div class="takeItFurther">
            <ol type="A">
            	<li>
                    Look inside <code>error reporting http</code>. How much of the JavaScript (JS) function can you read?
                    <div class="endnote">JS uses <code>!</code> for <img class="" src="/bjc-r/img/blocks/not.png" alt="empty not predicate" title="empty not predicate" /> and <code>=</code> for <img class="" src="/bjc-r/img/blocks/set.png" alt="empty set predicate" title="empty set predicate" />, but <code>if else</code> and <code>return</code> work the same as in Snap<em>!</em>.</div>
                </li>
				<li>Experiment to figure out how Google handles multiple-word web searches in URLs. Then edit your project so that it works for multiple-word searches.</li>
            </ol>
        </div>
        
        
        <h3>Determining the User's Location by IP Address</h3>
        <p>Your IP address contains information about your location, and apps can access this information.</p>
        
        <div class="ifTime">
            <ol start="8">
                <li>Write a Snap<em>!</em> reporter <img src="/bjc-r/img/4-internet/my-ip-addr.png" alt="my IP address"> that retrieves the IP address of the local device from <a href="http://bot.whatismyipaddress.com/" target="_blank">bot.whatismyipaddress.com</a> and reports it. </li>
                <li>Use Snap<em>!</em> to retrieve location information from <a href="http://ipinfo.io/" target="_blank">http://ipinfo.io/</a> by using the <code>proxied http</code> block:<img src="/bjc-r/img/4-internet/proxiedcombo.png" alt="Getting info about your IP"></li>
            </ol>
        <div class="endnote">Some Web sites also have handy ways for visitors to obtain more direct information. For example, <a href="http://ipinfo.io/72.229.28.185/loc" target="_blank">ipinfo.io/72.229.28.185/loc</a> returns just a latitude and longitude, instead of an HTML page; try <a href="http://ipinfo.io/72.229.28.185/city" target="_blank">/city</a> and <a href="http://ipinfo.io/72.229.28.185/postal" target="_blank">/postal</a> too. Sites that provide these features may have a page for developers, like <a href="http://ipinfo.io/developers" target="_blank">http://ipinfo.io/developers</a>.</div>
        </div>
        
        
	</body>
</html>
