<!DOCTYPE html>
<html lang="en">
	<head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<script type="text/javascript" src="/bjc-r/llab/loader.js"></script>
		<title>Unit 4 Lab 1: Website Data, Page 3</title>
	</head>
	<body>
		<h2>Reading the Web with Snap<em>!</em></h2>
		<div class="todo">This page is <em><strong>NOT</strong></em> ready for review. I'm combining what had been 3 pages: <a href="http://bjc.edc.org/bjc-r/cur/programming/4-internet/1-web-data-communication-protocols/1-read-web.html?topic=nyc_bjc%2F4-internet.topic&course=bjc4nyc_2015-2016.html&novideo&noassignment" target="_blank">Reading the Web with Snap!</a>, <a href="http://bjc.edc.org/bjc-r/cur/programming/4-internet/1-web-data-communication-protocols/2-scrape-data.html?topic=nyc_bjc%2F4-internet.topic&course=bjc4nyc_2015-2016.html&novideo&noassignment" target="_blank">Scraping Data from Web Pages</a>, and <a href="http://localhost/bjc-r/cur/programming/4-internet/4-weather-app/1-read-web-google.html?topic=nyc_bjc%2F4-internet.topic&course=bjc4nyc_2015-2016.html&novideo&noassignment" target="_blank">Reading Data Using URL Tags</a> into one page that previews GPS for "easy" first part and previews Weather app for "unlucky" hard part per Bowen's suggestion. All the "output of the <code>http</code> block" stuff is now covered by the previous page. --MF</div>
        
		<div class="todo">
			<ul>
				<li>Can we use a page with cleaner HTML than snap.berkeley.edu? Also, what if whatever page we use changes even a little and things no longer match up? Should we use a dummy page of our own designed for this lab? --MF
					<ul>
						<li>PG: yes, we should use our own page, and a <em>simple</em> one. The http block's report is ephemeral,  switching back and forth requires re-clicking the block, rechecking to see what the page says, and generally makes it almost impossible to see <em>anything</em> recognizable. As for looking at the text browser tab, can we assume everyone knows what they're looking for. "Above the page" is only a dim cue and we see only part of the text in that tab anyway.</li>
					</ul>
				</li>
			</ul>
		</div>
	
        <p>You access web pages and use their data for projects in Snap<em>!</em></p>
        <div class="forYouToDo" id="first">
            <ol>
                <li>Load <a class="run" href="/bjc-r/prog/4-internet/http-block.xml">this project</a>.</li>
                <li>
                	<img class="imageRight" src="/bjc-r/img/icons/talk-with-your-partner.png" alt="Talk with Your Partner" title="Talk with Your Partner" />Find the block <img src="/bjc-r/img/blocks/http.png" alt="http:// block"> in the Sensing palette, drag it into the scripting area, and click on it. What do you think the <code>http</code> block is reporting?<br />
                	<img src="/bjc-r/img/4-internet/s-b-e-reported.png" width="50%" alt="html text reported by http block">
                </li>
                <li>
                	In another browser window, open the page <a href="http://snap.berkeley.edu" target="_blank">http://snap.berkeley.edu</a> for reference. The page starts with two pictures (the Snap<em>!</em> logo and a screenshot), then some text.<br />
					<img src="/bjc-r/img/4-internet/s-b-e.png" width="50%" alt="snap.berkeley.edu as seen in browser">
                </li>
				<div class="todo">
                	This feels like a trick question, so I cut it. You sit and look through all this code that you don't understand, but there isn't actually anything there to find. --MF<br />
                    <ul>
                        <li><img class="inline" src="/bjc-r/img/icons/talk-with-your-partner-mini.png" alt="Talk with Your Partner" title="Talk with Your Partner" /> Do you see anything in the speech balloon (which shows just the beginning of what the <code>http</code> block reports) that you think corresponds to the actual page?</li>
                    </ul>
                </div>
                <li>It may not look like there is anything in the speech balloon that corresponds with the actual page, but look at the page title (in top bar of the browser window or tab). Can you find that text in what the <code>http</code> block reported?</li>
            </ol>
        </div>
        
        <p>
            The output of the <code>http</code> block is the code that creates the page at the address in the input slot. This web page notation, with things of the form:<br />
            <center>&lt;tag&gt;A bunch of text&lt;/tag&gt;</center><br />
            is a <em>special purpose programming language</em> (it's designed for a specific task) called <strong>HTML</strong> (HyperText Markup Language).
        </p>
        <div class="todo">From BH: 4.1.2  Something to keep is that HTML is a special purpose programming language.</div>
        
        <div class="comment">I know &lt;body&gt; is HTML code, but I think it's confusing to use the same formatting for HTML code as for Snap<em>!</em> code. --MF</div>
		<p>
        	Every web page has a <em>head</em> (that tells the browser how to format the page) and a <em>body</em> (that contains the actual information on the page). You'll see something more interesting if you skip over the head by looking for the text "&lt;body&gt;":<br />
			<img src="/bjc-r/img/4-internet/s-b-e-body.png" width="100%" alt="substring of (http: ...) starting with &lt;body&gt;">
		</p>
		
        <div class="forYouToDo">
			<ol start="5">
                <li>Identify the code for the two pictures and the beginning of the text that appear on the web page in that report from the <code>http</code> block.</li>
                <li>Try the <code>http</code> block with a different URL.</li>
            </ol>
        </div>
        
        <div class="comment">A security feature of what? Snap<em>!</em>? The browser? --MF</div>
        <p>You very likely got an empty result back.  This is because of a security feature that disallows one web site (such as the Snap<em>!</em> server) from sending a request to another site.  Fortunately for us, it's not a very bulletproof attempt at security...</p>
       
        <div class="forYouToDo">
            <ol start="7">
                <li>Find the <img src="/bjc-r/img/4-internet/proxied-http.png" alt="proxied http://"> block and try it with your favorite web site.</li>
                <li>Then look inside the block (right-click and choose "edit") to see how it works.</li>
                <div class="takeNote">
                    <div class="todo">
                      <p>We should say something about how <code>proxied http</code> works. I looked and I kinda get it, but I couldn't explain it. Here, I'll try anyway... --MF</p>
                      <p>PG: We <em>must</em> say something, because editing the block <em>doesn't</em> tell us how it works. It shows some magic thing we won't understand.</p>
                </div>
                    <p>The <code>proxied http</code> block uses a proxy server (crossorigin.me) to call the URL you enter. This bypasses (how?) the security of (Snap<em>!</em>? Your browser? Something... definitely something....) and accesses the code directly.</p>
                    <div class="todo">Brian, please fix that!! --MF :) Actually, Bowen has some nice ideas for handling this...</div>
				</div>
				<div class="todo"><ul>
                <li><div class="commentBig">PG: What is being saved? nothing has been <em><strong>built</strong></em>! And yet two pages from now (3-ip-routing) we're told to load this project from the "previous page<em><strong>s</strong></em>." <ul><li>Agreed. Shall we just have them load up the same starter project there then</li></ul></div><div class="saveAs"><span class="text">"U4L1-Web"</span><img src="/bjc-r/img/icons/save-this-as.png" alt="save your work as U4L4-Web" title="save your work as U4L4-Web" /></div></li>
                </ul></div>
            </ol>
        </div>
        
		<h2>Scraping Data from Web Pages</h2>
        
        <div class="sidenote">Weather forecast sites change their pages from time to time, so we're going to start with a web site we control. We'll build these blocks in a weather app in Lab 2.</div>
        <p>The Internet is full of information that you can use in your programs.  For example, you will write an <img src="/bjc-r/img/4-internet/umbrella.png" alt="umbrella? predicate" title="umbrella? predicate" /> block that looks up the weather forecast for your location and tells you whether or not to carry an umbrella or a block that reports the current temperature for a certain location:<br /><img class="indent" src="/bjc-r/img/4-internet/current-temp-62.png" alt="current temperature in (New York) reporting 62" title="current temperature in (New York) reporting 62" /></p>
        <p> We want a list of all the available libraries of Snap<em>!</em> blocks.</p>
                
        <div class="takeNote">
            <p><strong>Sometimes you're lucky,</strong> and a URL points directly to a data file:</p>
            <img src="/bjc-r/img/4-internet/libraries-txt.png" alt="text from URL snap.berkeley.edu/snapsource/libraries/LIBRARIES">
        </div>
        
        <div class="forYouToDo" id="first">
            <ol>
	            <li>If you don't already have it open, load your project "U4L1-Web" from the <a href="http://localhost/bjc-r/cur/programming/4-internet/1-web-data/3-read-web.html?topic=nyc_bjc%2F4-internet.topic&course=bjc4nyc_2015-2016.html&novideo&noassignment">previous page</a>.</li>
                <li>
                    The reported value above is a multi-line text string.  Just as you did for <em>words</em> and <em>sentences</em> in Unit 3, in this unit you'll often find it more convenient to have a list with one <em>line</em> per item.  In your scripting area you should see this script:<br />
                    <img src="/bjc-r/img/4-internet/libraries-txt-list.png" alt="split LIBRARIES by line"><br />
                    <div class="sidenote"><img src="/bjc-r/img/4-internet/drag-out.gif" width="75%" alt="animation of dragging out resize corner"></div>
                    Click on it, and pull out the bottom right corner of the stage watcher so that you can see the entire list.<br />
                    
                    <ul>
                        <li>Compare this list with the result in the speech balloon above.  What do you notice?</li>
                        <li>In the Snap<em>!</em> file menu, click on "Libraries..." and look at the submenu that appears.  Compare it with what's in the file.  Why do you think they're different?</li>
                    </ul>
                </li>
                <li>Find the <code>split</code> block in the Operators palette, and experiment with the different options for the second input slot. Read the help screen (right-click on a <code>split</code> block and choose "Help") if you need ideas.</li>
            </ol>
        </div>
        
        
        <div class="takeNote"><strong>When you're <em>not</em> lucky,</strong> the information you want is buried in a mass of HTML code.  Extracting the information from the formatting is called <em>scraping</em> the web page.</div>
        
        
        <div class="forYouToDo">
            <ol start="3">
                <li>In a new browser tab, visit the page <a href="http://snap.berkeley.edu/snapsource/libraries" target="_blank">http://snap.berkeley.edu/snapsource/libraries</a>.  How does it compare with the ...libraries/LIBRARIES one?</li>
                <li>
                    In your Snap<em>!</em> window, click on this script:<br />
                    <img src="/bjc-r/img/4-internet/libraries-dir-list.png" alt="split libraries by line"><br />
                    You're putting the result in a global variable only because there's a watcher for that variable on the stage, so it's easy to see the result.
                </li>
                <li>
                    We'd like to extract the list of files from this web page.  As a first step, use a higher order function to select only the list items that contain file names, rather than header text.  You'll find this block helpful:<br />
                    <img src="/bjc-r/img/4-internet/contains.png" alt="( ) contains ( ) ?">
                </li>
                <li>
                    The <code>scrape</code> block in this project is an attempt to scrape just the file names from the <code>libraries</code> web page.  It almost works, but it has a couple of problems.
                    <ul>
                        <li>
                            Read the code of <code>scrape</code> and make sure you understand how it works.  It uses helper blocks<br />
                            <img src="/bjc-r/img/4-internet/substring-starting.png" alt="substring of ( ) starting ( )"><br />
                            <img src="/bjc-r/img/4-internet/substring-upto.png" alt="substring of ( ) up to ( )"><br />
                            Notice the narrow input slot in the second of those; it's meant to let you know that only a single character goes there, not a multi-character string.  Experiment with these blocks.
                        </li>
                        <li>Fix the bugs in <code>scrape</code> so that you get a complete list of files and nothing else.</li>
                        <li>Try your <code>scrape</code> block on <a href="http://snap.berkeley.edu/snapsource/Costumes" target="_blank">snap.berkeley.edu/snapsource/Costumes</a> to make sure it can work on <em>any</em> file directory. ("Directory" is the technical term for what users call a "folder": a collection of files.)<img class="imageRight" src="/bjc-r/img/icons/save-now.png" alt="Now Is a Good Time to Save" title="Now Is a Good Time to Save" /></li>
                    </ul>
                </li>
            </ol>
        </div>         
               

		<h2>Reading Data Using URL Tags</h2>
        <div class="sidenote">The term <strong>URL</strong> is short for <em>Uniform Resource Locator</em>, a reference to an Internet resource such as a Web page.</div>
        <p>Many websites, such as Google, communicate information in the details in their URLs.</p>
        
        <div class="todo">from BH: Any reason we're using google.com (boo!) instead of duckduckgo.com (yay!)?</div>
        <div class="forYouToDo" id="first">
            <ol>
                <li>Starting from <a href="https://www.google.com" target="_blank">www.google.com</a>, type a one-word web search. What is the URL of your current web page?</li>
                <li>Change your URL to make Google search for a new topic.</li>
                <li>Experiment to figure out how Google handles multiple-word web searches in URLs.</li>
            </ol>
        </div>
        
        <div class="sidenote">When you see <code>https</code> instead of <code>http</code>, it means the information exchanged is secured via encryption.</div>
        
        <p>Your URL may add some details, but one of the simplest formats is <a href="https://www.google.com/#q=snap" target="_blank">https://www.google.com/#q=snap</a>.</p>
          
        <img src="/bjc-r/img/4-internet/snap-google.png" width="50%" align="middle" alt="SNAP search on Google">
        
		<div class="comment">BK: Need to prepare a more specific project base in #4. I have one, I just need to know the "rules" for setting these up and making them load, so for now I'm using the "read-web" project base.</div>
        
        <div class="comment">
          <p>Can we search for something other than "snap"? It's weird to me that it goes to a food bank page... --MF</p>
          <p>We certainly <em>can</em>. Stuff like that is always a choice we can make (it isn't essential AP, CS, or pedagogy). I don't find it weird, and I  even see it as potential a positive value, but it is also a potential political hot-button that could interfere with our mission to the very same kids that the government SNAP program is designed to serve. I worry some about that, but the fact that a search turns up <em>many</em> things, though, makes this seem safe. And, speaking of weird, did you notice that one is from 55 Chapel Street, Newton?! </p>
		  <p>I don't have a requirement to use "snap" here, I just thought it was clever. Berkeley Snap shows up on that page, too, but it's not the top hit. -BK</p>
</div>
        
        <div class="forYouToDo">
            <ol start="4">
                <div class="sidenote">Use the <img src="/bjc-r/img/4-internet/proxied-http.png" alt="Proxied HTTP block"> block to help.</div>
                <li>Starting from <a class="run" href="/bjc-r/prog/4-internet/http-block.xml">this project</a>, build a small app that asks for a one-word search query, then displays the URL to use for that Google search, and the HTML of the results from the search. Warning: don't expect the HTML to be easy-to-read!</li>
            </ol>
        </div>
        <div class="todo">Starting with <img src="/bjc-r/cur/programming/4-internet/4-weather-app/temporary-comment-images/U4L2pg1-project.png" alt="blan"> (which may not be the right project?) and <img src="/bjc-r/cur/programming/4-internet/4-weather-app/temporary-comment-images/scrape.png" alt="blah"> which is used in it, I don't see how students will solve problem 4.
		<p>The intent here is to return the HTML, no scraping involved. It won't return a fully useful result, partially because Google doesn't give you a very good style of return page. -BK</p>
		</div> 
         
        
        <div class="takeItFurther">
            <ol type="A">
            	<li>Edit your work so that it works for multiple-word searches.</li>
            </ol>
        </div>
	</body>
</html>
