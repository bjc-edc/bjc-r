<!DOCTYPE html>
<html lang="en">
	<head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<script type="text/javascript" src="/bjc-r/llab/loader.js"></script>
		<title>Unit 4 Lab 1: Website Data, Page 3</title>
		<style>.comment, .commentBig, .todo {display:none;}</style>
	</head>
	<body>
		<h2>Reading the Web with Snap<em>!</em></h2>
		<div class="todo">This page is <em><strong>NOT</strong></em> ready for review.</div>
        <div class="todo">This is a combination of what had been 3 pages: <a href="http://bjc.edc.org/bjc-r/cur/programming/4-internet/1-web-data-communication-protocols/1-read-web.html?topic=nyc_bjc%2F4-internet.topic&course=bjc4nyc_2015-2016.html&novideo&noassignment" target="_blank">Reading the Web with Snap!</a>, <a href="http://bjc.edc.org/bjc-r/cur/programming/4-internet/1-web-data-communication-protocols/2-scrape-data.html?topic=nyc_bjc%2F4-internet.topic&course=bjc4nyc_2015-2016.html&novideo&noassignment" target="_blank">Scraping Data from Web Pages</a>, and <a href="http://localhost/bjc-r/cur/programming/4-internet/4-weather-app/1-read-web-google.html?topic=nyc_bjc%2F4-internet.topic&course=bjc4nyc_2015-2016.html&novideo&noassignment" target="_blank">Reading Data Using URL Tags</a>. The goal is to previews GPS for "easy" first part and Weather app for "unlucky" hard part per Bowen's suggestion. --MF</div>
        
		<div class="todo">
			<ul>
				<li>Can we use a page with cleaner HTML than snap.berkeley.edu? Also, what if whatever page we use changes even a little and things no longer match up? Should we use a dummy page of our own designed for this lab? --MF
					<ul>
						<li>PG: yes, we should use our own page, and a <em>simple</em> one. The http block's report is ephemeral,  switching back and forth requires re-clicking the block, rechecking to see what the page says, and generally makes it almost impossible to see <em>anything</em> recognizable. As for looking at the text browser tab, can we assume everyone knows what they're looking for. "Above the page" is only a dim cue and we see only part of the text in that tab anyway.</li>
						<li>The problem with this is that the http block is very finicky and one has to use the proxied http block most of the time. So, for the intro, I kept snap.berkeley.edu after all. --MF</li>
                        <li>I'm also much less worried about this now because we have the "Writing for the Web with HTML" page. --MF</li>
					</ul>
				</li>
			</ul>
		</div>
	
        <p>The Internet is full of information that you can use in your programs.  For example in Lab 4, you will write an <img class="inline" src="/bjc-r/img/4-internet/umbrella.png" alt="umbrella? predicate" title="umbrella? predicate" /> block that looks up the weather forecast for your location and tells you whether or not to carry an umbrella. You'll also build a <code>current temperature in</code> block that reports the current temperature for a certain location:<br /><img class="indent" src="/bjc-r/img/4-internet/current-temp-62.png" alt="current temperature in (New York) reporting 62" title="current temperature in (New York) reporting 62" /></p>
        <div class="endnote">Weather forecast sites change their pages from time to time, so we're going to start with a web site we control.</div>
        <!--<div class="ifTime" id="first">
			<div class="endnote">
				<strong>What's with the "?q=" in the URL <a href="https://duckduckgo.com/?q=my+ip+address" target="_blank">https://duckduckgo.com/?q=my+ip+address</a>?</strong><br />
				The "?q=" tells the duckduckgo.com server to run the query "my+ip+address," which returns the client's (your) IP address. (The "q" is for "query" as we are querying the server for information.)
			</div>
        	<ol start="3">
                <li>What do you think the #q= query string in this URL is doing?<br />
                <center><a href="https://www.google.com/#q=tcp/ip" target="_blank">https://www.google.com/#q=tcp/ip</a></center>
                </li>
            </ol>
        </div>-->
        
        <div class="forYouToDo" id="first">
            <ol>
                <li>Load <a class="run" href="/bjc-r/prog/4-internet/http-block.xml">this project</a>.</li>
                <li>
                	<img class="imageRight" src="/bjc-r/img/icons/talk-with-your-partner.png" alt="Talk with Your Partner" title="Talk with Your Partner" />Click on the<img class="inline" src="/bjc-r/img/4-internet/http-reporting.png" alt="http:// block"> block. What do you think the <code>http</code> block is reporting?<br />
                	<img src="/bjc-r/img/4-internet/s-b-e-reported.png" width="50%" alt="html text reported by http block">
                </li>
                <li>
                	In another browser window, open the page <a href="http://snap.berkeley.edu" target="_blank">http://snap.berkeley.edu</a> for reference. The page starts with two pictures (the Snap<em>!</em> logo and a screenshot), then some text.<br />
					<img src="/bjc-r/img/4-internet/s-b-e.png" width="50%" alt="snap.berkeley.edu as seen in browser">
                </li>
                <li>It may not look like there is anything in the speech balloon that corresponds with the actual page, but look at the page title (in the top bar of the browser window or tab). Can you find that text in what the <code>http</code> block reported?</li>
            </ol>
        </div>
        
        <div class="todo">From BH: 4.1.2  Something to keep is that HTML is a special purpose programming language.<ul><li>I moved this to <a href="http://localhost/bjc-r/cur/programming/4-internet/1-web-data/2-writing-html.html?topic=nyc_bjc%2F4-internet.topic&course=bjc4nyc_2015-2016.html&novideo&noassignment">Writing for the Web with HTML</a> right after the first FYTD box. Please review what I wrote there and then remove this comment. --MF</li></ul></div>
        <p>The output of the <code>http</code> block is the HTML code that creates the page at the address in the input slot.</p>
        
		<p>
        	Every web page has a <em>head</em> (that tells the browser how to format the page) and a <em>body</em> (that contains the actual information on the page). You'll see something more interesting if you skip over the head by looking for the text "&lt;body&gt;":<br />
			<img src="/bjc-r/img/4-internet/s-b-e-body.png" width="100%" alt="substring of (http: ...) starting with &lt;body&gt;">
		</p>
		
        <div class="forYouToDo">
			<ol start="5">
                <li>Identify the code for the two pictures and the beginning of the text that appear on the web page in that report from the <code>http</code> block.</li>
                <li>
                	Try the <code>http</code> block with a different URL. (Hint: it's probably not going to work. So, just try it and keep reading.)
                	<div class="endnote">
                    	Be sure <em>not</em> to include the "http://" in the input slot. That's already included as part of the <code>http</code> block.<br />
                    	<img class="indent" src="/bjc-r/img/4-internet/http-http.png" alt="Don't include the 'http://' in the http block input slot." title="Don't include the 'http://' in the http block input slot." />
                    </div>
                </li>
            </ol>
        </div>
        
        <div class="commentBig">A security feature of what? Snap<em>!</em>? The browser? --MF</div>
        <p>When using the <code>http</code> block with a custom URL, you very likely got an empty result back.  This is because of a security feature that disallows one web site (such as the Snap<em>!</em> server) from sending a request to another site.  Fortunately for us, it's not a very bulletproof attempt at security...</p>
       
        <div class="forYouToDo">
            <ol start="7">
                <li>Try the <img src="/bjc-r/img/4-internet/proxied-http.png" alt="proxied http://"> block with your URL. (Hint: this time, it should work. Be sure <em>not</em> to include the "http://" in the input slot.) </li>
                <div class="takeNote">
					<p>The <code>http proxied</code> block works by fooling the other web site into sending you data it wouldn’t normally send. Most websites receive a request coming from Snap<em>!</em> and say “this isn’t a real web browser query, so I’m not answering.” The <code>proxied http</code> block uses a proxy (a replacement or stand-in) server (in this case, <a href="http://crossorigin.me/" target="_blank">crossorigin.me</a>) to call the URL you enter. The proxy server performs the request properly (like a browser would), gets the information, and sends it to Snap<em>!</em> as though things went smoothly.</p>
                    <img class="indent" src="/bjc-r/img/4-internet/proxied-http-definition.png" alt="proxied http:// %url {report (http:// (join (crossorigin.me/http://) (url)))}" title="proxied http:// %url {report (http:// (join (crossorigin.me/http://) (url)))}" />
                	<p>In short, the <code>proxied http</code> block works the way we want the <code>http</code> block to work.</p>
                </div>
            </ol>
        </div>
        
        
		<h3>Scraping Data from Web Pages</h3>
        <div class="endnote">In Lab 2, you will work with a set of GPS coordinates (coordinates on the surface of the earth). On the next pages, you will learn more about what they are and how to use them. For now, you will learn how to get them into Snap<em>!</em></div>
        <p><strong>Sometimes you're lucky,</strong> and a URL points directly to a file with the data you want...</p>
        
        <div class="forYouToDo">
            <ol start="8">
                <li>
                	<div class="sidenote">CSV stands for "comma separated values." A CSV file is a table of information. CVS files usually open in a spreadsheet program.</div>
                	Try the <img src="/bjc-r/img/4-internet/proxied-http.png" alt="proxied http://"> block with this URL:<br />
                    <p class="center"><a href="http://bjc.edc.org/bjc-r/cur/programming/4-internet/2-gps-data/GPS-NYC.csv" target="_blank">http://bjc.edc.org/bjc-r/cur/programming/4-internet/2-gps-data/GPS-NYC.csv</a></p>	
                </li>
                <li>
                    The value reported is a long text string. You'll find it more convenient to have a list with one line per item. In your scripting area you should see this script:<br />
                    <img class="indent" src="/bjc-r/img/4-internet/set-coordinates-to-split-CSV.png" alt="set (coordinates) to {split (http(http://bjc.edc.org/bjc-r/cur/programming/4-internet/2-gps-data/GPS-NYC.csv)) by (line)}" title="set (coordinates) to {split (http(http://bjc.edc.org/bjc-r/cur/programming/4-internet/2-gps-data/GPS-NYC.csv)) by (line)}" />
                    <!--<img src="/bjc-r/img/4-internet/libraries-txt-list.png" alt="split LIBRARIES by line"><br />-->
                    <img class="imageRight" src="/bjc-r/img/4-internet/drag-out.gif" alt="animation of dragging out resize corner" />
                    <p>Click on it, and pull out the bottom right corner of the stage watcher so that you can see the entire list.</p>
                    <!--<ul>
                        <li>Compare this list with the result in the speech balloon above.  What do you notice?</li>
                        <li>In the Snap<em>!</em> file menu, click on "Libraries..." and look at the sub-menu that appears.  Compare it with what's in the file.  Why do you think they're different?</li>
                    </ul>-->
                </li>
                <li>
                	Convert this list into a list of lists:
                    <div class="sidenoteBig">Read the help screen (right-click on a <code>split</code> block and choose "Help") if you need ideas.</div>
                    <ul>
                    	<li>
                        	Add a <code>for</code> loop to the end of this script that replaces each item in the <var>coorinates</var> list with a list of each piece of the coordinate pair (like the image below).<br />
                        </li>
                        <li>You will need to use the <code>split</code> block a second time. Experiment with different options for the second input slot.</li>
                    </ul>
					<img class="indent" src="/bjc-r/img/4-internet/coordinates-list-of-lists.png" alt="list of lists of coordinate pairs" title="list of lists of coordinate pairs" />
                </li>
                <li><div class="saveAs"><span class="text">"U4L2-GPSData"</span><img src="/bjc-r/img/icons/save-this-as.png" alt="Save your work as U4L2-GPSData" title="Save your work as U4L2-GPSData" /> You will use this file in the next lab.</div></li>
            </ol>
        </div>
        
        
        <p><strong>When you're <em>not</em> lucky,</strong> the information you want is buried in a mass of HTML code. Extracting the information from the formatting is called <em>scraping</em> the web page.</p>
        
        
        <div class="forYouToDo">
            <ol start="12">
                <li>In a new browser tab, visit the page <a href="http://snap.berkeley.edu/snapsource/libraries" target="_blank">http://snap.berkeley.edu/snapsource/libraries</a>.  How does it compare with the ...libraries/LIBRARIES one?</li>
                <li>
                    In your Snap<em>!</em> window, click on this script:<br />
                    <img src="/bjc-r/img/4-internet/libraries-dir-list.png" alt="split libraries by line"><br />
                    You're putting the result in a global variable only because there's a watcher for that variable on the stage, so it's easy to see the result.
                </li>
                <li>
                    We'd like to extract the list of files from this web page.  As a first step, use a higher order function to select only the list items that contain file names, rather than header text.  You'll find this block helpful:<br />
                    <img src="/bjc-r/img/4-internet/contains.png" alt="( ) contains ( ) ?">
                </li>
                <li>
                    The <code>scrape</code> block in this project is an attempt to scrape just the file names from the <code>libraries</code> web page.  It almost works, but it has a couple of problems.
                    <ul>
                        <li>
                            Read the code of <code>scrape</code> and make sure you understand how it works.  It uses helper blocks<br />
                            <img src="/bjc-r/img/4-internet/substring-starting.png" alt="substring of ( ) starting ( )"><br />
                            <img src="/bjc-r/img/4-internet/substring-upto.png" alt="substring of ( ) up to ( )"><br />
                            Notice the narrow input slot in the second of those; it's meant to let you know that only a single character goes there, not a multi-character string.  Experiment with these blocks.
                        </li>
                        <li>Fix the bugs in <code>scrape</code> so that you get a complete list of files and nothing else.</li>
                        <li>Try your <code>scrape</code> block on <a href="http://snap.berkeley.edu/snapsource/Costumes" target="_blank">snap.berkeley.edu/snapsource/Costumes</a> to make sure it can work on <em>any</em> file directory. ("Directory" is the technical term for what users call a "folder": a collection of files.)<img class="imageRight" src="/bjc-r/img/icons/save-now.png" alt="Now Is a Good Time to Save" title="Now Is a Good Time to Save" /></li>
                    </ul>
                </li>
            </ol>
        </div>         
               

		<h2>Reading Data Using URL Tags</h2>
        <div class="sidenote">The term <strong>URL</strong> is short for <em>Uniform Resource Locator</em>, a reference to an Internet resource such as a Web page.</div>
        <p>Many websites, such as Google, communicate information in the details in their URLs.</p>
        
        <div class="todo">from BH: Any reason we're using google.com (boo!) instead of duckduckgo.com (yay!)?</div>
        <div class="forYouToDo" id="first">
            <ol>
                <li>Starting from <a href="https://www.google.com" target="_blank">www.google.com</a>, type a one-word web search. What is the URL of your current web page?</li>
                <li>Change your URL to make Google search for a new topic.</li>
                <li>Experiment to figure out how Google handles multiple-word web searches in URLs.</li>
            </ol>
        </div>
        
        <div class="sidenote">When you see <code>https</code> instead of <code>http</code>, it means the information exchanged is secured via encryption.</div>
        
        <p>Your URL may add some details, but one of the simplest formats is <a href="https://www.google.com/#q=snap" target="_blank">https://www.google.com/#q=snap</a>.</p>
          
        <img src="/bjc-r/img/4-internet/snap-google.png" width="50%" align="middle" alt="SNAP search on Google">
        
		<div class="comment">BK: Need to prepare a more specific project base in #4. I have one, I just need to know the "rules" for setting these up and making them load, so for now I'm using the "read-web" project base.</div>
        
        <div class="comment">
          <p>Can we search for something other than "snap"? It's weird to me that it goes to a food bank page... --MF</p>
          <p>We certainly <em>can</em>. Stuff like that is always a choice we can make (it isn't essential AP, CS, or pedagogy). I don't find it weird, and I  even see it as potential a positive value, but it is also a potential political hot-button that could interfere with our mission to the very same kids that the government SNAP program is designed to serve. I worry some about that, but the fact that a search turns up <em>many</em> things, though, makes this seem safe. And, speaking of weird, did you notice that one is from 55 Chapel Street, Newton?! </p>
		  <p>I don't have a requirement to use "snap" here, I just thought it was clever. Berkeley Snap shows up on that page, too, but it's not the top hit. -BK</p>
</div>
        
        <div class="forYouToDo">
            <ol start="4">
                <div class="sidenote">Use the <img src="/bjc-r/img/4-internet/proxied-http.png" alt="Proxied HTTP block"> block to help.</div>
                <li>Starting from <a class="run" href="/bjc-r/prog/4-internet/http-block.xml">this project</a>, build a small app that asks for a one-word search query, then displays the URL to use for that Google search, and the HTML of the results from the search. Warning: don't expect the HTML to be easy-to-read!</li>
            </ol>
        </div>
        <div class="todo">Starting with <img src="/bjc-r/cur/programming/4-internet/4-weather-app/temporary-comment-images/U4L2pg1-project.png" alt="blan"> (which may not be the right project?) and <img src="/bjc-r/cur/programming/4-internet/4-weather-app/temporary-comment-images/scrape.png" alt="blah"> which is used in it, I don't see how students will solve problem 4.
		<p>The intent here is to return the HTML, no scraping involved. It won't return a fully useful result, partially because Google doesn't give you a very good style of return page. -BK</p>
		</div> 
         
        
        <div class="takeItFurther">
            <ol type="A">
            	<li>Edit your work so that it works for multiple-word searches.</li>
            </ol>
        </div>
	</body>
</html>
